{"ast":null,"code":"import _toConsumableArray from\"/Users/aamirp/programming/fullstack-open-2020/part2/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/aamirp/programming/fullstack-open-2020/part2/phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import phonebookService from'./services/phonebook';import Filter from\"./components/Filter\";import PersonForm from'./components/PersonForm';import Persons from'./components/Persons';import Notification from'./components/Notification';var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newNumber=_useState6[0],setNewNumber=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),filter=_useState8[0],setFilter=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),notif=_useState10[0],setNotif=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),success=_useState12[0],setSuccess=_useState12[1];useEffect(function(){phonebookService.getAll().then(function(response){return setPersons(response);});},[]);// Create a copy of the persons array that can be filtered if a search term is inputted\nvar new_persons=_toConsumableArray(persons);if(filter){new_persons=new_persons.filter(function(person){return person.name.toLowerCase().includes(filter.toLowerCase());});}var handleFilterChange=function handleFilterChange(e){return setFilter(e.target.value);};var handleNameChange=function handleNameChange(e){return setNewName(e.target.value);};var handleNumberChange=function handleNumberChange(e){return setNewNumber(e.target.value);};var handleFormSubmit=function handleFormSubmit(event){event.preventDefault();var duplicate=persons.filter(function(person){return person.name===newName;});//console.log(\"DUP:\", duplicate)\nif(duplicate.length){var choice=window.confirm(\"\".concat(newName,\" is already added to phonebook, replace the old number with a new one?\"));if(choice===true){var updatePerson=duplicate[0];updatePerson.number=newNumber;phonebookService.update(updatePerson).then(function(returnedPerson){setPersons(persons.map(function(person){return person.id!==updatePerson.id?person:returnedPerson;}));setNotif(\"Updated \".concat(returnedPerson.name));setSuccess(true);setTimeout(function(){setNotif(null);setSuccess(null);},5000);});}}else{var newPerson={name:newName,number:newNumber};phonebookService.create(newPerson).then(function(response){setPersons(persons.concat(response));console.log(\"Added: \",response);setNotif(\"Added \".concat(response.name));setSuccess(true);setTimeout(function(){setNotif(null);setSuccess(null);},5000);});setNewName(\"\");setNewNumber(\"\");}};var handleDelete=function handleDelete(person){var result=window.confirm(\"Delete \".concat(person.name));if(result===true){phonebookService.remove(person.id).then(function(response){return console.log(\"DELETED\",person);}).catch(function(error){setNotif(\"Information of \".concat(person.name,\" has already been removed from the server\"));setSuccess(false);setTimeout(function(){setNotif(null);setSuccess(null);},5000);});var updatedPersons=persons.filter(function(p){return p.id!==person.id;});setPersons(updatedPersons);}};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Phonebook\"),/*#__PURE__*/React.createElement(Notification,{message:notif,success:success}),/*#__PURE__*/React.createElement(Filter,{filter:filter,handleChange:handleFilterChange}),/*#__PURE__*/React.createElement(\"h2\",null,\"add a new\"),/*#__PURE__*/React.createElement(PersonForm,{newName:newName,newNumber:newNumber,handleNameChange:handleNameChange,handleNumberChange:handleNumberChange,handleFormSubmit:handleFormSubmit}),/*#__PURE__*/React.createElement(\"h2\",null,\"Numbers\"),/*#__PURE__*/React.createElement(Persons,{persons:new_persons,handleDelete:handleDelete}));};export default App;","map":{"version":3,"sources":["/Users/aamirp/programming/fullstack-open-2020/part2/phonebook/src/App.js"],"names":["React","useState","useEffect","phonebookService","Filter","PersonForm","Persons","Notification","App","persons","setPersons","newName","setNewName","newNumber","setNewNumber","filter","setFilter","notif","setNotif","success","setSuccess","getAll","then","response","new_persons","person","name","toLowerCase","includes","handleFilterChange","e","target","value","handleNameChange","handleNumberChange","handleFormSubmit","event","preventDefault","duplicate","length","choice","window","confirm","updatePerson","number","update","returnedPerson","map","id","setTimeout","newPerson","create","concat","console","log","handleDelete","result","remove","catch","error","updatedPersons","p"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\n\nimport phonebookService from './services/phonebook'\nimport Filter from \"./components/Filter\"\nimport PersonForm from './components/PersonForm'\nimport Persons from './components/Persons'\nimport Notification from './components/Notification'\n\nconst App = () => {\n  const [ persons, setPersons] = useState([])\n  const [ newName, setNewName ] = useState('')\n  const [ newNumber, setNewNumber ] = useState('')\n  const [ filter, setFilter ] = useState('')\n  const [ notif, setNotif ] = useState(null)\n  const [ success, setSuccess ] = useState(null)\n\n  useEffect(() => {\n    phonebookService.getAll()\n      .then(response => setPersons(response))\n  }, []);\n\n  // Create a copy of the persons array that can be filtered if a search term is inputted\n  let new_persons = [...persons]\n\n  if (filter) {\n    new_persons = new_persons.filter(person => person.name.toLowerCase().includes(filter.toLowerCase())) \n  }\n\n  const handleFilterChange = (e) => setFilter(e.target.value)\n\n  const handleNameChange = (e) => setNewName(e.target.value)\n\n  const handleNumberChange = (e) => setNewNumber(e.target.value)\n\n  const handleFormSubmit = (event) => {\n    event.preventDefault()\n\n    const duplicate = persons.filter(person => person.name === newName)\n\n    //console.log(\"DUP:\", duplicate)\n    if (duplicate.length) {\n      const choice = window.confirm(`${newName} is already added to phonebook, replace the old number with a new one?`)\n\n      if (choice === true) {\n        let updatePerson = duplicate[0]\n        updatePerson.number = newNumber\n        phonebookService.update(updatePerson)\n          .then(returnedPerson => {\n            setPersons(persons.map(person => person.id !== updatePerson.id ? person:  returnedPerson))\n\n            setNotif(`Updated ${returnedPerson.name}`)\n            setSuccess(true)\n  \n            setTimeout(() => {\n              setNotif(null)\n              setSuccess(null)\n            }, 5000)\n          })\n      }\n    }\n\n    else {\n      const newPerson = { \n        name: newName, \n        number: newNumber \n      }\n\n      phonebookService.create(newPerson)\n        .then(response => {\n          setPersons(persons.concat(response))\n          console.log(\"Added: \", response)\n          setNotif(`Added ${response.name}`)\n          setSuccess(true)\n\n          setTimeout(() => {\n            setNotif(null)\n            setSuccess(null)\n          }, 5000)\n        })\n\n      setNewName(\"\")\n      setNewNumber(\"\")\n    }\n  }\n\n  const handleDelete = (person) => {\n   const result = window.confirm(`Delete ${person.name}`)\n\n    if (result === true) {\n      phonebookService.remove(person.id)\n        .then(response => console.log(\"DELETED\", person))\n        .catch(error => {\n          setNotif(`Information of ${person.name} has already been removed from the server`)\n          setSuccess(false)\n\n          setTimeout(() => {\n            setNotif(null)\n            setSuccess(null)\n          }, 5000)\n        })\n\n      const updatedPersons = persons.filter(p => p.id !== person.id)\n      setPersons(updatedPersons)\n    }\n  }\n\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      <Notification message={notif} success={success}/>\n\n      <Filter filter={filter} handleChange={handleFilterChange} />\n\n      <h2>add a new</h2>\n      <PersonForm\n        newName={newName}\n        newNumber={newNumber}\n        handleNameChange={handleNameChange}\n        handleNumberChange={handleNumberChange}\n        handleFormSubmit={handleFormSubmit}\n      />\n\n      <h2>Numbers</h2>\n      <Persons persons={new_persons} handleDelete={handleDelete}/>\n    </div>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}